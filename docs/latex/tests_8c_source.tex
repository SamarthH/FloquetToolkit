\hypertarget{tests_8c_source}{}\doxysection{tests.\+c}
\label{tests_8c_source}\index{src/tests.c@{src/tests.c}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{preprocessor}{\#include <stdio.h>}}
\DoxyCodeLine{00002 \textcolor{preprocessor}{\#include <gsl/gsl\_math.h>}}
\DoxyCodeLine{00003 \textcolor{preprocessor}{\#include <math.h>}}
\DoxyCodeLine{00004 \textcolor{preprocessor}{\#include "\mbox{\hyperlink{floquet_8h}{floquet.h}}"}}
\DoxyCodeLine{00005 }
\DoxyCodeLine{\Hypertarget{tests_8c_source_l00006}\mbox{\hyperlink{tests_8c_a7761662b3a0f21d771c5f8bcfecef57f}{00006}} \textcolor{preprocessor}{\#define K\_DAMP 0.1}}
\DoxyCodeLine{00007 }
\DoxyCodeLine{\Hypertarget{tests_8c_source_l00008}\mbox{\hyperlink{tests_8c_aee399d91b0a63dca32ab53cac972c6f6}{00008}} \textcolor{keywordtype}{void} \mbox{\hyperlink{tests_8c_aee399d91b0a63dca32ab53cac972c6f6}{print\_int\_matrix\_to\_file\_csv}}(\textcolor{keywordtype}{int} n1, \textcolor{keywordtype}{int} n2, \textcolor{keywordtype}{int}** m, FILE* file)}
\DoxyCodeLine{00009 \{}
\DoxyCodeLine{00010     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < n1; ++i)}
\DoxyCodeLine{00011     \{}
\DoxyCodeLine{00012         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < n2-\/1; ++j)}
\DoxyCodeLine{00013         \{}
\DoxyCodeLine{00014             fprintf(file,\textcolor{stringliteral}{"\%d,"},m[i][j]);}
\DoxyCodeLine{00015         \}}
\DoxyCodeLine{00016         fprintf(file,\textcolor{stringliteral}{"\%d\(\backslash\)n"},m[i][n2-\/1]);}
\DoxyCodeLine{00017     \}}
\DoxyCodeLine{00018 \}}
\DoxyCodeLine{00019 }
\DoxyCodeLine{\Hypertarget{tests_8c_source_l00020}\mbox{\hyperlink{tests_8c_a690436f1a7d241218bab44325b9727f8}{00020}} \textcolor{keywordtype}{void} \mbox{\hyperlink{tests_8c_a690436f1a7d241218bab44325b9727f8}{print\_double\_matrix\_to\_file\_csv}}(\textcolor{keywordtype}{int} n1, \textcolor{keywordtype}{int} n2, \textcolor{keywordtype}{double}** m, FILE* file)}
\DoxyCodeLine{00021 \{}
\DoxyCodeLine{00022     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < n1; ++i)}
\DoxyCodeLine{00023     \{}
\DoxyCodeLine{00024         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < n2-\/1; ++j)}
\DoxyCodeLine{00025         \{}
\DoxyCodeLine{00026             fprintf(file,\textcolor{stringliteral}{"\%lf,"},m[i][j]);}
\DoxyCodeLine{00027         \}}
\DoxyCodeLine{00028         fprintf(file,\textcolor{stringliteral}{"\%lf\(\backslash\)n"},m[i][n2-\/1]);}
\DoxyCodeLine{00029     \}}
\DoxyCodeLine{00030 \}}
\DoxyCodeLine{00031 }
\DoxyCodeLine{00032 }
\DoxyCodeLine{\Hypertarget{tests_8c_source_l00033}\mbox{\hyperlink{tests_8c_ae893fc79e0825431fab5a04ae1d8a885}{00033}} \textcolor{keywordtype}{void} \mbox{\hyperlink{tests_8c_ae893fc79e0825431fab5a04ae1d8a885}{mathieu\_undamped}}(\textcolor{keywordtype}{double} t, gsl\_matrix* A\_val, \textcolor{keywordtype}{void}* \mbox{\hyperlink{namespaceplotter__2d_a51f20d6b1b54a2eee3be0e8adc96a0ae}{param}})}
\DoxyCodeLine{00034 \{}
\DoxyCodeLine{00035     \textcolor{keywordtype}{double}* par\_temp = (\textcolor{keywordtype}{double}*) \mbox{\hyperlink{namespaceplotter__2d_a51f20d6b1b54a2eee3be0e8adc96a0ae}{param}};}
\DoxyCodeLine{00036     gsl\_matrix\_set\_zero(A\_val);}
\DoxyCodeLine{00037     gsl\_matrix\_set(A\_val,0,1,1.);}
\DoxyCodeLine{00038     gsl\_matrix\_set(A\_val,1,0,-\/(par\_temp[1] + par\_temp[0]*cos(2.*t)));}
\DoxyCodeLine{00039 \}}
\DoxyCodeLine{00040 }
\DoxyCodeLine{\Hypertarget{tests_8c_source_l00041}\mbox{\hyperlink{tests_8c_aaa6ac9d4a6cf948c78ecee95ac26d2c5}{00041}} \textcolor{keywordtype}{void} \mbox{\hyperlink{tests_8c_aaa6ac9d4a6cf948c78ecee95ac26d2c5}{mathieu\_damped\_fixed\_k}}(\textcolor{keywordtype}{double} t, gsl\_matrix* A\_val, \textcolor{keywordtype}{void}* \mbox{\hyperlink{namespaceplotter__2d_a51f20d6b1b54a2eee3be0e8adc96a0ae}{param}})}
\DoxyCodeLine{00042 \{}
\DoxyCodeLine{00043     \textcolor{keywordtype}{double}* par\_temp = (\textcolor{keywordtype}{double}*) \mbox{\hyperlink{namespaceplotter__2d_a51f20d6b1b54a2eee3be0e8adc96a0ae}{param}};}
\DoxyCodeLine{00044     gsl\_matrix\_set\_zero(A\_val);}
\DoxyCodeLine{00045     gsl\_matrix\_set(A\_val,0,1,1.);}
\DoxyCodeLine{00046     gsl\_matrix\_set(A\_val,1,0,-\/(par\_temp[1] + par\_temp[0]*cos(2.*t)));}
\DoxyCodeLine{00047     gsl\_matrix\_set(A\_val,1,1,-\/(\mbox{\hyperlink{tests_8c_a7761662b3a0f21d771c5f8bcfecef57f}{K\_DAMP}}));}
\DoxyCodeLine{00048 \}}
\DoxyCodeLine{00049 }
\DoxyCodeLine{\Hypertarget{tests_8c_source_l00050}\mbox{\hyperlink{tests_8c_ae66f6b31b5ad750f1fe042a706a4e3d4}{00050}} \textcolor{keywordtype}{int} \mbox{\hyperlink{tests_8c_ae66f6b31b5ad750f1fe042a706a4e3d4}{main}}()}
\DoxyCodeLine{00051 \{}
\DoxyCodeLine{00052     \textcolor{keywordtype}{int} n = 2;}
\DoxyCodeLine{00053     \textcolor{keywordtype}{double} T = M\_PI;}
\DoxyCodeLine{00054 }
\DoxyCodeLine{00055     \textcolor{keywordtype}{double} start[2] = \{60.,-\/5.\};}
\DoxyCodeLine{00056     \textcolor{keywordtype}{double} end[2] = \{0., 20.\};}
\DoxyCodeLine{00057     \textcolor{keywordtype}{int} \mbox{\hyperlink{namespaceplotter__2d_adfaad771c2d636eec6ac27f95f256e1a}{nstep}}[2] = \{320,320\};}
\DoxyCodeLine{00058     \textcolor{keywordtype}{int}** \mbox{\hyperlink{namespaceplotter__3d_a1df8fcdacfec00fc258a3c72772c2f18}{stability}} = (\textcolor{keywordtype}{int}**) malloc(\mbox{\hyperlink{namespaceplotter__2d_adfaad771c2d636eec6ac27f95f256e1a}{nstep}}[0]*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}*));}
\DoxyCodeLine{00059     gsl\_complex** largest\_multiplier = NULL;}
\DoxyCodeLine{00060     \textcolor{keywordtype}{double}** largest\_multiplier\_abs = (\textcolor{keywordtype}{double}**) malloc(\mbox{\hyperlink{namespaceplotter__2d_adfaad771c2d636eec6ac27f95f256e1a}{nstep}}[0]*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}*));}
\DoxyCodeLine{00061 }
\DoxyCodeLine{00062     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{namespaceplotter__2d_adfaad771c2d636eec6ac27f95f256e1a}{nstep}}[0]; ++i)}
\DoxyCodeLine{00063     \{}
\DoxyCodeLine{00064         \mbox{\hyperlink{namespaceplotter__3d_a1df8fcdacfec00fc258a3c72772c2f18}{stability}}[i] = (\textcolor{keywordtype}{int}*) malloc(\mbox{\hyperlink{namespaceplotter__2d_adfaad771c2d636eec6ac27f95f256e1a}{nstep}}[1]*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{00065         largest\_multiplier\_abs[i] = (\textcolor{keywordtype}{double}*) malloc(\mbox{\hyperlink{namespaceplotter__2d_adfaad771c2d636eec6ac27f95f256e1a}{nstep}}[1]*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{00066     \}}
\DoxyCodeLine{00067 }
\DoxyCodeLine{00068 }
\DoxyCodeLine{00069     \mbox{\hyperlink{floquet_8h_a673ff8696700805393fd28cec169efdd}{floquet\_get\_stability\_array\_real\_double\_param\_general}}(n, \mbox{\hyperlink{tests_8c_aaa6ac9d4a6cf948c78ecee95ac26d2c5}{mathieu\_damped\_fixed\_k}}, T, start, end, \mbox{\hyperlink{namespaceplotter__2d_adfaad771c2d636eec6ac27f95f256e1a}{nstep}}, \mbox{\hyperlink{namespaceplotter__3d_a1df8fcdacfec00fc258a3c72772c2f18}{stability}}, largest\_multiplier, largest\_multiplier\_abs);}
\DoxyCodeLine{00070     }
\DoxyCodeLine{00071     FILE* file = fopen(\textcolor{stringliteral}{"stability.csv"},\textcolor{stringliteral}{"w"});}
\DoxyCodeLine{00072     \mbox{\hyperlink{tests_8c_aee399d91b0a63dca32ab53cac972c6f6}{print\_int\_matrix\_to\_file\_csv}}(\mbox{\hyperlink{namespaceplotter__2d_adfaad771c2d636eec6ac27f95f256e1a}{nstep}}[0],\mbox{\hyperlink{namespaceplotter__2d_adfaad771c2d636eec6ac27f95f256e1a}{nstep}}[1],\mbox{\hyperlink{namespaceplotter__3d_a1df8fcdacfec00fc258a3c72772c2f18}{stability}},file);}
\DoxyCodeLine{00073     fclose(file);}
\DoxyCodeLine{00074 }
\DoxyCodeLine{00075     file = fopen(\textcolor{stringliteral}{"largest\_multiplier\_abs.csv"},\textcolor{stringliteral}{"w"});}
\DoxyCodeLine{00076     \mbox{\hyperlink{tests_8c_a690436f1a7d241218bab44325b9727f8}{print\_double\_matrix\_to\_file\_csv}}(\mbox{\hyperlink{namespaceplotter__2d_adfaad771c2d636eec6ac27f95f256e1a}{nstep}}[0],\mbox{\hyperlink{namespaceplotter__2d_adfaad771c2d636eec6ac27f95f256e1a}{nstep}}[1],largest\_multiplier\_abs,file);}
\DoxyCodeLine{00077     fclose(file);}
\DoxyCodeLine{00078 }
\DoxyCodeLine{00079     file = fopen(\textcolor{stringliteral}{"extraparams.txt"},\textcolor{stringliteral}{"w"});}
\DoxyCodeLine{00080     fprintf(file,\textcolor{stringliteral}{"Damped Mathieu Stability Plot (\$k=0.1\$)\(\backslash\)n"});}
\DoxyCodeLine{00081     fprintf(file,\textcolor{stringliteral}{"\$\(\backslash\)\(\backslash\)delta\$\(\backslash\)n"});}
\DoxyCodeLine{00082     fprintf(file,\textcolor{stringliteral}{"\$\(\backslash\)\(\backslash\)epsilon\$\(\backslash\)n"});}
\DoxyCodeLine{00083     fprintf(file,\textcolor{stringliteral}{"\%lf \%lf\(\backslash\)n"},start[0],start[1]);}
\DoxyCodeLine{00084     fprintf(file,\textcolor{stringliteral}{"\%lf \%lf\(\backslash\)n"},end[0],end[1]);}
\DoxyCodeLine{00085     fprintf(file,\textcolor{stringliteral}{"\%d \%d\(\backslash\)n"},\mbox{\hyperlink{namespaceplotter__2d_adfaad771c2d636eec6ac27f95f256e1a}{nstep}}[0], \mbox{\hyperlink{namespaceplotter__2d_adfaad771c2d636eec6ac27f95f256e1a}{nstep}}[1]);}
\DoxyCodeLine{00086     fclose(file);}
\DoxyCodeLine{00087     }
\DoxyCodeLine{00088     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < \mbox{\hyperlink{namespaceplotter__2d_adfaad771c2d636eec6ac27f95f256e1a}{nstep}}[0]; ++i)}
\DoxyCodeLine{00089     \{}
\DoxyCodeLine{00090         free(\mbox{\hyperlink{namespaceplotter__3d_a1df8fcdacfec00fc258a3c72772c2f18}{stability}}[i]);}
\DoxyCodeLine{00091         free(largest\_multiplier\_abs[i]);}
\DoxyCodeLine{00092     \}}
\DoxyCodeLine{00093 }
\DoxyCodeLine{00094     free(\mbox{\hyperlink{namespaceplotter__3d_a1df8fcdacfec00fc258a3c72772c2f18}{stability}});}
\DoxyCodeLine{00095     free(largest\_multiplier\_abs);}
\DoxyCodeLine{00096     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00097 \}}

\end{DoxyCode}
